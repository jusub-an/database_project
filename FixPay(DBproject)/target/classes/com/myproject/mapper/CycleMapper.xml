<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.myproject.mapper.CycleMapper">
    <select id="getList" resultType="com.myproject.domain.CycleVO">
	    SELECT 
	        cy.cycle_id, cy.name, cy.months_interval,
	        (SELECT COUNT(*) FROM Fixed_Expense e 
	         WHERE e.cycle_id = cy.cycle_id 
	         AND e.user_id = #{user_id} AND e.is_active = 1) as expenseCount
	    FROM Payment_Cycle cy
	    ORDER BY cy.months_interval
	</select>
</mapper>